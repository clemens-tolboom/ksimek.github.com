
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Calibrated Cameras and gluPerspective &larr; </title>
   <meta name="author" content="Kyle Simek" />

   <link rel="start" href="/" />

	
	
    <link rel="shortcut icon" href="/favicon.ico">

	
  	<link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/sightations" title="RSS feed" />
	
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/syntax.css" type="text/css" />

   <!-- Jquery UI CSS --!>
	

   <!-- Homepage CSS -->
   <link media="screen" rel="stylesheet" href="/assets/themes/mark-reid/css/screen.css" type="text/css" />

   <!-- Handheld CSS -->
   <link media="handheld, only screen and (max-width: 480px), only screen and (max-device-width: 480px)" href="/assets/themes/mark-reid/css/handheld.css" type="text/css" rel="stylesheet" />


<!--[if IEMobile]>
<link rel="stylesheet" type="text/css" href="/assets/themes/mark-reid/css/handheld.css" media="screen" />
<![endif]-->

   <!-- Mathjax Javascript -->

	
   <script type="text/javascript"
     src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
   </script>
    

   <!-- three.js Javascript -->
	
	
	

	

</head>
<body id="">
<div id="site">
  
  <div id="header">
    <h1>
    	<a href="/" title="Sightations">Sightations</a>
    	<span class="byline">&larr; <a href="/">A Computer Vision Blog</a></span>
    </h1>
    <ul class="nav">
      <li><a class="home" href="/">Home</a></li>
      <li><a href="/about.html">About</a></li>
      <li><a href="/contact.html">Contact</a></li>
      <li><a href="/code.html">Code</a></li>
      <li><a  href="/archive.html">Archive</a></li>
      <li><a  href="/feeds.html"><img src="/img/feed-icon.gif" /></a></li> 

    </ul>
  </div>

  
<div id="page" class="article">
	
  
  
  <h1 class="title">Calibrated Cameras and gluPerspective</h1>

  <div class="date emphnext">June 18, 2013</div>
    


  
    
    <div class="notice">Is your company looking to hire a software engineer in computer vision? Let's talk!   I'm approaching the end of my PhD and am considering positions starting Fall 2015.  Check out the <a href="/contact.html">contact page</a> for more info.</div>

    

    <p>After posting my last article <a href="/2013/06/03/calibrated_cameras_in_opengl/">relating glFrustum to the intrinsic camera matrix</a>, I receieved some emails asking how the (now deprecated) <a href="http://pic.dhe.ibm.com/infocenter/aix/v6r1/index.jsp?topic=%2Fcom.ibm.aix.opengl%2Fdoc%2Fopenglrf%2FgluPerspective.htm">gluPerspective</a> function relates to the intrinsic matrix.  We can show a similar result with <code>gluPerspective</code> as we did with <code>glFrustum</code>, namely that it is the product of a <code>glOrtho</code> matrix and a (modified) intrinsic camera matrix, but in this case the intrinsic matrix has different constraints.  I'll be re-using notation and concepts from the previous article, so if you aren't familiar with them, I recommend reading it first.</p>

<p><span id="more"></span></p>


<h2>Decomposing gluPerspective</h2>

<p>The matrix generated by <code>gluPerspective</code> is</p>

<div> \[
\begin{align}

\left (
        \begin{array}{cccc}
        \frac{f}{\text{aspect}} & 0 & 0 & 0 \\
        0 & f & 0 & 0 \\
        0 & 0 & C' & D' \\
        0 & 0 & -1 & 0
        \end{array}
\right )

\end{align}
\]
</div>


<p>where</p>

<div> \[
\begin{align}
f &= \cot(fovy/2) \\
C' &= -\frac{far + near}{far - near}  \\
D' &= -\frac{2 \; far \; near}{far - near}  \\
\end{align}
\]
</div>


<p>Like with <code>glFrustum</code>, <code>gluPerspective</code> permits no axis skew, but it also restricts the viewing volume to be centered around the camera's principal (viewing) axis.  This means that the principal point offsets \(x_0\) and \(y_0\) must be zero, <em>and</em> the matrix generated by <code>glOrtho</code> must be centered, i.e. <code>bottom = -top</code> and <code>left = -right</code>.  The <em>Persp</em> matrix corresponding to the intrinsic matrix is:</p>

<div>\[ Persp = \left( \begin{array}{cccc} \alpha & 0 & 0 & 0 \\ 0 & \beta & 0 & 0 \\ 0 & 0 & A & B \\ 0 & 0 & -1 & 0 \end{array} \right)  \]</div>


<p>where</p>

<div> \[ \begin{align}
A &= near + far \\
B &= near * far
\end{align} \]
</div>


<p>and the <em>NDC</em> matrix is</p>

<div>\[ \begin{align}
NDC &= \left( \begin{array}{cccc} 
        \frac{2}{right - left} & 0 & 0 & t_x \\ 
        0 & \frac{2}{top - bottom} & 0 & t_y \\ 
        0 & 0 & -\frac{2}{far - near} & t_z \\
        0 & 0 & 0 & 1 
    \end{array} \right) \\[1.5em]
      &= \left( \begin{array}{cccc}
              \frac{2}{width} & 0 & 0 & 0 \\ 
              0 & \frac{2}{height} & 0 & 0 \\
              0 & 0 & -\frac{2}{far - near} & t_z \\
              0 & 0 & 0 & 1 
      \end{array} \right) 

    \end{align}
\]</div>


<p>where</p>

<div> \[ \begin{align}
t_x &= -\frac{right + left}{right - left} \\
t_y &= -\frac{top + bottom}{top - bottom} \\
t_z &= -\frac{far + near}{far - near} 
\end{align} \]
</div>


<p>It is easy to show that the product \((NDC \times Persp)\) is equivalent to the matrix generated by <code>gluPerspective(fovy, aspect, near, far)</code> with</p>

<div>\[ \begin{align}
\text{fovy} &= 2 \text{arctan}\left (\frac{\text{height}}{2 \beta} \right ) \\
\text{aspect} &= \frac{\beta}{\alpha} \frac{\text{width}}{\text{height}}.
\end{align}
\]
</div>


<h2>glFrustum vs. gluPerpsective </h2>

<p>In my experience, the zero-skew assumption is usually reasonable, so <code>glFrustum</code> can provide a decent approximation to the full intrinsic matrix.  However there is quite often a non-negligible principal point offset (~ 2% of the image size), even in high-quality cameras.  For this reason, <code>gluPerspective</code> might be a good choice for quick-and-dirty demos, but for the most accurate simulation, you should use the full camera  matrix <a href="/2013/06/03/calibrated_cameras_in_opengl/">like I described previously</a>.</p>


    

      <address class="signature">
        Posted by
        <a class="author" href="/">Kyle Simek</a> 
      </address>
  


  
  <div class="prev-next">
  
    <a href="/2013/08/13/intrinsic/" class="next" title="Dissecting the Camera Matrix, Part 3: The Intrinsic Matrix">Dissecting the Camera Matrix, Part 3: The Intrinsic Matrix &rarr;</a>
  
  
    <a href="/2013/06/03/calibrated_cameras_in_opengl/" class="prev" title="Calibrated Cameras in OpenGL without glFrustum">&larr; Calibrated Cameras in OpenGL without glFrustum</a>
  
  </div>
  <div class="clearer"> </div>

<div class="post-sharing">
 

  
  		<div id="fb-root"></div>

<div class="post-share ulno mob">

<!-- Hacker News -->
<span class="hn"><span id="hnews"></span></span>

<!-- Twitter -->
<span class="tw"><a href="https://twitter.com/share" class="twitter-share-button" data-text="Calibrated Cameras and gluPerspective" data-via="" data-related="" data-count="" data-size="">Tweet</a></span>

<!-- Google+ -->
<span class="gp"><div class="g-plusone" data-size="medium" data-annotation="bubble" data-width=""></div></span>

<!-- Facebook -->
<!--
<span class="fb"><div class="fb-like" data-send="false" data-layout="button_count" data-width="90" data-show-faces="false" data-font=""></div></span>
-->

<!-- Reddit -->
<script type="text/javascript" src="http://www.reddit.com/static/button/button1.js"></script>
</div>

<script>
  
(function(doc, script) {
 	
	//Async Social Buttons
    var js, 
        fjs = doc.getElementsByTagName(script)[0],
        add = function(url, id) {
            if (doc.getElementById(id)) {return;}
            js = doc.createElement(script);
            js.src = url;
            id && (js.id = id);
            fjs.parentNode.insertBefore(js, fjs);
        };
    
    // Twitter SDK
    add('//platform.twitter.com/widgets.js', 'twitter-wjs');

    // Google+ button
    add('https://apis.google.com/js/plusone.js');
    
    // Facebook SDK
    add('//connect.facebook.net/en_GB/all.js#xfbml=1&appId=123', 'facebook-jssdk');
    
    //Hacker News Button 	
 	var hn_like = document.createElement('iframe');
      hn_like.frameborder="no";
      hn_like.scrolling="no";
      hn_like.height="28px";
      hn_like.width="110px";
      hn_like.style="border:0px;";
      hn_like.src = "http://hnlike.com/upvote.php?link="
                    + encodeURIComponent(document.location)
                    + "&title="
                    + encodeURIComponent("Calibrated Cameras and gluPerspective");
      hn_like.innerHTML="iframes not supported by your browser";
      
      var where = document.getElementById("hnews");
      where.parentNode.insertBefore(
        hn_like,
        where
      );
}(document, 'script'));

</script>

  



</div>




  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'sightations'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  
</div><!-- End Page -->



  
  <div id="footer">
  	<address>
  		<span class="copyright">
  			Content by <a href="/about.html">Kyle Simek</a>. Original design by 
  			<a href="http://mark.reid.name/">Mark Reid</a>
  			<br/>
  			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
  		</span>
  		<span class="engine">
  			Powered by <a href="https://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
  		</span>
  	</address>
  </div>
  
</div>

<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->

  


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33692744-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




</body>
</html>

